
# Сервис заявок для 1440.test

ТЕСТОВОЕ ЗАДАНИЕ!!!!!!

Этот репозиторий содержит код микросервиса для работы с заявками сотрудников компании 1440.test. Сервис предназначен для автоматизации обработки заявок сотрудников на различные внутренние сервисы. Проект использует современные технологии, такие как FastAPI, PostgreSQL, Redis и Docker, для обеспечения производительности, масштабируемости и удобства развертывания.

## Обзор

### Цель
Микросервис заявок отвечает за управление заявками сотрудников внутри компании. Он предоставляет REST API для создания, обновления и получения информации о заявках. Сервис также включает интеграцию с системами аутентификации.

### Основные функции
- **Управление заявками**: Создание, обновление и получение заявок сотрудников.
- **Аутентификация**: OAuth 2.0 через Discord для аутентификации пользователей.
- **Асинхронная обработка**: Использование очередей задач для обработки заявок.
- (Не дописана)**Уведомления**: Отправка обновлений по электронной почте или через Slack при изменении статуса заявки.
- **Логирование и мониторинг**: Ведение журналов всех действий с заявками и мониторинг состояния сервиса.
    Само логирование найти можно, зайдя в redis и в `logs:actions:<guid_action>` будет храниться вся информация

## Технические характеристики

### Используемые технологии
- **Язык программирования**: Python 3.9+
- **Фреймворк**: FastAPI
- **База данных**: PostgreSQL
- **Кэширование**: Redis
- **Контейнеризация**: Docker

### API Эндпоинты

#### Аутентификация OAuth 2.0
- **Получение ссылки для авторизации**: `/api/discord/auth_link`  
  Возвращает URL для начала процесса аутентификации через OAuth 2.0 с Discord.

- **Завершение авторизации**: `/api/discord/auth`  
  Завершает процесс аутентификации с использованием кода, предоставленного Discord.

#### Управление заявками
- **Открытие заявки**: `/api/tickets/open`  
  Открывает новую заявку. Требуется `access_token` в заголовках.

- **Изменение статуса заявки**: `/api/tickets/change_status`  
  Обновляет статус существующей заявки. Требуется `access_token` в заголовках.

- **Получение списка заявок**: `/api/tickets/get`  
  Получает список заявок с возможностью фильтрации. Требуется `access_token` в заголовках.

### Функциональные требования
1. **Создание заявок**: Отправка новых запросов.
2. **Обновление статуса**: Изменение статуса существующих запросов.
3. **Получение списка заявок**: Получение списка заявок с возможностью фильтрации.
4. **Асинхронная обработка**: Обработка запросов с использованием очередей.
5. **Уведомления**: Отправка уведомлений при изменении статуса.

### Нефункциональные требования
- **Покрытие тестами**: Обеспечить 80% покрытия unit-тестами.
- **Масштабируемость**: Обработка не менее 1000 запросов в минуту.
- **Отказоустойчивость**: Реализовать механизмы повторных попыток при сбоях.
- **Документация**: Предоставить документацию API с использованием Swagger.

### Дополнительные функции
- **CI/CD Pipeline**: Настроить систему непрерывной интеграции и развертывания.
- **Мониторинг**: Реализовать систему мониторинга состояния сервиса.

## Начало работы

### Предварительные требования
- Docker
- Python 3.9+

### Установка
1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/yourusername/ticket-service.git
   ```
2. Перейдите в директорию проекта:
   ```bash
   cd ticket-service
   ```
3. Соберите и запустите Docker-контейнеры:
   ```bash
   docker-compose up --build
   ```

### Использование
После запуска сервиса API будет доступен по адресу `http://localhost:8000`. Документация API будет доступна по адресу `http://localhost:8000/docs`.

## Документация
Подробная документация API доступна в [Swagger UI](http://localhost:8000/docs).

## Контакты
По вопросам и поддержке, пожалуйста, обращайтесь:
- **Автор**: Иванов Андрей (aka Arefa Satellite)
- **Telegram**: [@arefaste](https://t.me/arefaste)

